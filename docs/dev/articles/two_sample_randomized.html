<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ppseq">
<title>Two-sample randomized trial • ppseq</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Two-sample randomized trial">
<meta property="og:description" content="ppseq">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ppseq</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.2.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/one_sample_expansion.html">One-sample expansion cohort</a>
    <a class="dropdown-item" href="../articles/two_sample_randomized.html">Two-sample randomized trial</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/zabore">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Two-sample randomized trial</h1>
                        <h4 data-toc-skip class="author">Emily C.
Zabor</h4>
            
            <h4 data-toc-skip class="date">Last updated: 2022-07-21</h4>
      
      
      <div class="d-none name"><code>two_sample_randomized.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>To execute the code in this vignette, you first need to install and
load the {ppseq} package. You will also need the {future} package to
parallelize your code to improve speed.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#install.packages("ppseq")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ppseq</span><span class="op">)</span>
<span class="co">#install.packages("future")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Efforts to develop biomarker-targeted anti-cancer therapies have
progressed rapidly in recent years. Witht he aim of expediting
regulatory reviews of promising therapies, an increasing number of
targeted cancer therapies are being granted accelerated approval on the
basis of evidence acquired in single-arm phase II clinical trials. The
historical control rates used to design and evaluate emerging targeted
therapies in single-arm trials often arise as population averages,
lacking specificity to the biomarker-targeted subpopulation of interest.
Thus, historical trial results are inherently limited for inferring the
potential “comparative efficacy” of novel targeted therapies.
Randomization may be the best option in this setting, and is not out of
the question given the increasingly large sample sizes being used in
phase II trials. We propose a design for two-arm randomized phase II
trials based on sequential predictive probability monitoring that allows
an investigator to identify an optimal clinical trial design within
contraints of traditional type I error and power, and with futility
stopping rules that preserve valuable human and financial resources
(cite two-sample paper once it’s available).</p>
</div>
<div class="section level2">
<h2 id="case-study-background">Case study background<a class="anchor" aria-label="anchor" href="#case-study-background"></a>
</h2>
<p>Atezolizumab is a programmed death-ligand 1 (PD-L1) blocking
monoclonal antibody that was given accelerated approval by the U.S. Food
and Drug Administration in May 2016 for the treatment of patients with
locally advanced or metastatic urothelial carcinoma who had disease
progression following platinum-containing chemotherapy. The approval was
based on the results of a single-arm phase II study in 310 patients
<span class="citation">(Rosenberg et al. 2016)</span>. The phase II
study used a hierarchical fixed-sequence testing procedure to test
increasingly broad subgroups of patients based on PD-L1 status, and
found overall response rates of 26% (95% CI: 18-36), 18% (95% CI:
13-24), and 15% (95% CI 11-19) in patients with ≥5% PD-L1-positive
immune cells (IC2/3 subgroup), in patients with ≥1% PD-L1-positive
immune cells (IC1/2/3 subgroup), and in all patients, respectively <span class="citation">(Rosenberg et al. 2016)</span>. All three rates
exceeded the historical control rate of 10%. Then, in March 2021, the
approval in this indication was voluntarily withdrawn by the sponsor
following negative results from a randomized phase III study <span class="citation">(Powles et al. 2018)</span>. In the phase III study,
931 patients were randomly assigned to receive atezolizumab or
chemotherapy in a 1:1 ratio, and the same hierarchical fixed-sequence
testing procedure as in the phase II study was used. The phase III study
found that overall survival did not differ significantly between the
atezolizumab and chemotherapy groups of the IC2/3 subgroup (median
survival 11.1 months [95% CI: 8.6-15.5] versus 10.6 months [95% CI:
8.4-12.2]), so no further testing was conducted for the primary endpoint
(3). Further analyses revealed that while the response rates to
atezolizumab were comparable to those seen in the phase II study, the
response rates to chemotherapy were much higher than the historical
control rate of 10%. The overall response rates to chemotherapy were
21.6% (95% CI: 14.5-30.2), 14.7% (95% CI: 10.9-19.2), and 13.4% (95% CI:
10.5-16.9) for the IC2/3 subgroup, IC1/2/3 subgroup, and all patients,
respectively. The overall response rates to atezolizumab were 23% (95%
CI: 15.6-31.9), 14.1% (95% CI: 10.4-18.5), and 13.4% (95% CI: 10.5-16.9)
for the IC2/3 subgroup, IC1/2/3 subgroup, and all patients,
respectively. These results indicate that PD-L1 status is a predictive
biomarker for both standard of care chemotherapies that comprised the
control arm as well as atezolizumab in this patient population.</p>
</div>
<div class="section level2">
<h2 id="re-design-of-case-study">Re-design of case study<a class="anchor" aria-label="anchor" href="#re-design-of-case-study"></a>
</h2>
<p>We will demonstrate the use of the functions in {ppseq} to re-design
the phase II trial of atezolizumab using a two-arm randomized design
with sequential predictive probability monitoring. We focus here on the
main biomarker subgroup of interest, the IC2/3 subgroup. We design the
study with a null response rate of 0.1 in both arms, and an alternative
response rate of 0.25 in the atezolizumab arm. We plan the study with
100 participants, assuming that the total sample size available is
similar to the 310 used in the actual single-arm phase II trial, and
that a third of that patient population fall into our desired biomarker
subgroup. We will check for futility after every 10 patients are
enrolled on each arm. To design the study, we need to calibrate the
design over a range of posterior probability thresholds and predictive
probability thresholds.</p>
<p>The posterior probability is calculated from the posterior
distribution based on the specified priors and the data observed so far,
and represents the probability of success based only on the data accrued
so far. A posterior probability threshold would be set during the design
stage and if, at the end of the trial, the posterior probability
exceeded the pre-specified threshold, the trial would be declared a
success. The posterior predictive probability is the probability that,
at a given interim monitoring point, the treatment will be declared
efficacious at the end of the trial when full enrollment is reached,
conditional on the currently observed data and the specified priors.
Predictive probability provides an intuitive monitoring framework that
tells an investigator what the chances are of declaring the treatment
efficacious at the end of the trial if we were to continue enrolling to
the maximum planned sample size, given the data observed so far in the
trial. If this probability drops below a certain threshold, which is
pre-specified during the design stage, the trial would be stopped early.
Predictive probability thresholds closer to 0 lead to less frequent
stopping for futility, whereas thresholds near 1 lead to frequent
stopping unless there is almost certain probability of success.</p>
<p>We consider a grid of thresholds so that we have a range of possible
designs from which to select a design with optimal operating
characteristics such as type I error, power, and sample size under the
null and alternative. In this example we will consider posterior
thresholds of 0.7, 0.74, 0.78, 0.82, 0.86, 0.9, 0.92, 0.93, 0.94, 0.95,
0.96, 0.97, 0.98, and 0.99, and predictive thresholds of 0.05, 0.1,
0.15, and 0.2.</p>
</div>
<div class="section level2">
<h2 id="using-calibrate_thresholds-to-obtain-design-options">Using <code>calibrate_thresholds()</code> to obtain design
options<a class="anchor" aria-label="anchor" href="#using-calibrate_thresholds-to-obtain-design-options"></a>
</h2>
<p>To conduct the case study re-design, we use the
<code><a href="../reference/calibrate_thresholds.html">calibrate_thresholds()</a></code> function from the {ppseq} package.
This function is written using the <code>future</code> and
<code>furrr</code> packages, but the user will have to set up a call to
<code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">future::plan</a></code> that is appropriate for their operating
environment and their simulation setup prior to running the function. In
this example, we used the following code on a Unix server with 192
cores, with the goal of utilizing 56 cores since our grid of thresholds
to consider was 14 posterior thresholds by 4 predictive thresholds.</p>
<p>The <code><a href="../reference/calibrate_thresholds.html">calibrate_thresholds()</a></code> function will simulate
<code>nsim</code> datasets under the null hypothesis and
<code>nsim</code> datasets under the alternative hypothesis. For each
simulated dataset, every combination of posterior and predictive
thresholds will be considered and the final sample size and whether or
not the trial was positive will be saved. Then across all simulated
datasets, <code><a href="../reference/calibrate_thresholds.html">calibrate_thresholds()</a></code> will return the average
sample size under the null, the average sample size under the
alternative, the proportion of positive trials under the null (i.e. the
type I error), and the proportion of positive trials under the
alternative (i.e. the power).</p>
<p>Because <code><a href="../reference/calibrate_thresholds.html">calibrate_thresholds()</a></code> randomly generates
simulated datasets, you will want to set a seed before running the
function in order to ensure your results are reproducible.</p>
<p>The inputs to <code><a href="../reference/calibrate_thresholds.html">calibrate_thresholds()</a></code> for our case study
re-design include <code>p_null = c(0.1, 0.1)</code> as the null response
rate, <code>p_alt = c(0.1, 0.25)</code> as the alternative response
rate, <code>n = cbind(seq(10, 50, 10), seq(10, 50, 10))</code> indicates
interim looks after every 10 patients up to a total of 50 in each arm,
<code>N = c(50, 50)</code> indicates the final total sample size of 50
in each arm, <code>direction = "greater"</code> specifies that interest
is in whether the response rate in the experimental arm exceeds the
response rate in the control arm, <code>delta = 0</code> is the default
for the clinically meaningful difference in the two-sample case,
<code>prior = c(0.5, 0.5)</code> specifies that both hyperparameters of
the prior beta distribution be set to 0.5, <code>S = 5000</code>
specifies that 5000 posterior samples will be drawn to calculate the
posterior and predictive probabilities, and <code>nsim = 1000</code>
specifies that we will generate 1000 simulated datasets under both the
null and the alternative. <code>pp_threshold</code> is a vector of the
posterior thresholds of interest and <code>ppp_threshold</code> is a
vector of predictive thresholds of interest. Note that due to the
computational time involved, the object produced from the below example
code <code>two_sample_cal_tbl</code> is available as a dataset in the
{ppseq} package.</p>
<!-- The below code was run on the server from H:\ppseq-papers\two_sample_cal_tbl-server.R -->
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>

<span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/multicore.html" class="external-link">multicore</a></span><span class="op">(</span>workers <span class="op">=</span> <span class="fl">56</span><span class="op">)</span><span class="op">)</span>

<span class="va">two_sample_cal_tbl</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/calibrate_thresholds.html">calibrate_thresholds</a></span><span class="op">(</span>p_null <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>, 
                       p_alt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.25</span><span class="op">)</span>, 
                       n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,
                       N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>, 
                       pp_threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.74</span>, <span class="fl">0.78</span>, <span class="fl">0.82</span>, <span class="fl">0.86</span>, <span class="fl">0.9</span>, 
                                        <span class="fl">0.92</span>, <span class="fl">0.93</span>, <span class="fl">0.94</span>, <span class="fl">0.95</span>, <span class="fl">0.96</span>, <span class="fl">0.97</span>, 
                                        <span class="fl">0.98</span>, <span class="fl">0.99</span><span class="op">)</span>,
                       ppp_threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span><span class="op">)</span>,
                       direction <span class="op">=</span> <span class="st">"greater"</span>, 
                       delta <span class="op">=</span> <span class="fl">0</span>, 
                       prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, 
                       S <span class="op">=</span> <span class="fl">5000</span>, 
                       nsim <span class="op">=</span> <span class="fl">1000</span>
                       <span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Powles2018" class="csl-entry">
Powles, T., I. Durán, M. S. van der Heijden, Y. Loriot, N. J. Vogelzang,
U. De Giorgi, S. Oudard, et al. 2018. <span>“Atezolizumab Versus
Chemotherapy in Patients with Platinum-Treated Locally Advanced or
Metastatic Urothelial Carcinoma (IMvigor211): A Multicentre, Open-Label,
Phase 3 Randomised Controlled Trial.”</span> Journal Article.
<em>Lancet</em> 391 (10122): 748–57. <a href="https://doi.org/10.1016/s0140-6736(17)33297-x" class="external-link">https://doi.org/10.1016/s0140-6736(17)33297-x</a>.
</div>
<div id="ref-Rosenberg2016" class="csl-entry">
Rosenberg, J. E., J. Hoffman-Censits, T. Powles, M. S. van der Heijden,
A. V. Balar, A. Necchi, N. Dawson, et al. 2016. <span>“Atezolizumab in
Patients with Locally Advanced and Metastatic Urothelial Carcinoma Who
Have Progressed Following Treatment with Platinum-Based Chemotherapy: A
Single-Arm, Multicentre, Phase 2 Trial.”</span> Journal Article.
<em>Lancet</em> 387 (10031): 1909–20. <a href="https://doi.org/10.1016/s0140-6736(16)00561-4" class="external-link">https://doi.org/10.1016/s0140-6736(16)00561-4</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Emily C. Zabor, Brian P. Hobbs, Michael J. Kane.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
